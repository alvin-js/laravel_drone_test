---
kind: pipeline
type: docker
name: test

platform:
  os: linux
  arch: amd64

steps:
- name: ssh-git-pull
  pull: if-not-exists
  image: appleboy/drone-ssh
  environment:
    ENV:
      from_secret: env
  settings:
    host: 35.229.238.232
    username: alvin
    port: 22
    key:
      from_secret: privateKey
    envs: [ENV]
    script:
      - cd /var/www/html/laravel_drone_test
      - sudo git pull
      - sudo bash -c "echo 1234567 > .env"


#- name: build-nginx-image
#  pull: if-not-exists
#  image: plugins/docker
#  settings:
#    registry: registry.hub.docker.com
#    repo: registry.hub.docker.com/virtualorz/docker_compose_nginx_build
#    dockerfile: dockerfiles/dockerfile_for_nginx/Dockerfile
#    auto_tag: true
#    username: virtualorz
#    password: 2uxirgil

#- name: build-php-image
#  pull: if-not-exists
#  image: plugins/docker
#  settings:
#    registry: registry.hub.docker.com
#    repo: registry.hub.docker.com/virtualorz/dev_compose_php73_laravel_build
#    dockerfile: dockerfiles/dockerfile_for_laravel/Dockerfile
#    auto_tag: true
#    username: virtualorz
#    password: 2uxirgil
